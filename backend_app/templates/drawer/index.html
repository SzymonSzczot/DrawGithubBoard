{% load utils %}

<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="Mark Otto, Jacob Thornton, and Bootstrap contributors">
    <meta name="generator" content="Hugo 0.88.1">
    <title>Draw your Github</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">

    <link rel="canonical" href="https://getbootstrap.com/docs/5.1/examples/dashboard/">


    <!-- Bootstrap core CSS -->
    <link href="/docs/5.1/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">

    <!-- Favicons -->
    <link rel="apple-touch-icon" href="/docs/5.1/assets/img/favicons/apple-touch-icon.png" sizes="180x180">
    <link rel="icon" href="/docs/5.1/assets/img/favicons/favicon-32x32.png" sizes="32x32" type="image/png">
    <link rel="icon" href="/docs/5.1/assets/img/favicons/favicon-16x16.png" sizes="16x16" type="image/png">
    <link rel="manifest" href="/docs/5.1/assets/img/favicons/manifest.json">
    <link rel="mask-icon" href="/docs/5.1/assets/img/favicons/safari-pinned-tab.svg" color="#7952b3">
    <link rel="icon" href="/docs/5.1/assets/img/favicons/favicon.ico">
    <meta name="theme-color" content="#7952b3">


    <style>
        #marker {
            position: absolute;
            z-index: 9;
            background-color: #98b3a0;
            text-align: center;
            border: 1px solid #d3d3d3;
            height: 400px;
            width: 500px;
            opacity: 50%;
        }
        .square {
            height: 22px;
            width: 22px;
        }
        .list-group-item {
            padding: 0;
        }
        .clicked {
            background: greenyellow;
        }
    </style>
</head>
<body>


<div class="container-fluid">
    <div class="row">
        <nav id="sidebarMenu" class="col-md-3 col-lg-2 d-md-block bg-light sidebar collapse">
            <div class="position-sticky pt-3">
                <ul class="nav flex-column">
                    <li class="nav-item">
                        <a class="nav-link active" aria-current="page" href="#">
                            <span data-feather="home"></span>
                            Preview
                        </a>

                    </li>
                </ul>


            </div>
        </nav>

        <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4">
            <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                <h1 class="h2">Preview</h1>
                <div class="btn-toolbar mb-2 mb-md-0">
                </div>
            </div>
{#                <div id="marker"></div>#}
                    <div id="drawingTable">
                    {% for year in "2021"|as_range:"2022" %}
                        {% for week in "1"|as_range:"6" %}
                            <div style="display: inline-block">
                            <ul class="list-group">
                                {% for day in "1"|as_range:"8" %}
                                    {% with year|concat:"_"|concat:week|concat:"_"|concat:day as point_identifier %}
                                    <button id="{{ point_identifier }}"
                                            type="button"
                                            class="list-group-item square {% if point_identifier in points %} clicked {% endif %}"
                                            onclick="dayClick(this)">
                                    </button>
                                    {% endwith %}
                                {% endfor %}
                            </ul>
                            </div>
                        {% endfor %}
                    {% endfor %}
                    </div>
                <script>
                function dayClick(button) {
                    let drawing_id = window.location.href.toString().split("/").at(-1).replace("#", "");
                    let grid_start = document.getElementsByClassName("square")[0].id;
                    let data = {
                        "drawing": parseInt(drawing_id),
                        "position": button.id,
                        "grid_start": grid_start,
                    };
                  if (button.classList.toggle("clicked")){
                      data["method"] = "POST"
                    fetch("/drawing/pixels/", {
                      method: "POST",
                      headers: {'Content-Type': 'application/json'},
                      body: JSON.stringify(data)
                    }).then(response => response.json()
                    ).then(data => document.getElementById("recommendations").innerHTML = data["prediction_html"]);
                    }
                  else {
                      data["method"] = "DELETE"
                    fetch("/drawing/pixels/", {
                      method: "POST",
                      headers: {'Content-Type': 'application/json'},
                      body: JSON.stringify(data)
                    }).then(response => response.json()
                    ).then(data => document.getElementById("recommendations").innerHTML = data["prediction_html"]);
                  }
                }
                </script>
                <script>
                    //Make the DIV element draggagle:
                    dragElement(document.getElementById("marker"));

                    function dragElement(elmnt) {
                      var pos1 = 0, pos2 = 0, pos3 = 0, pos4 = 0;
                      if (document.getElementById(elmnt.id + "header")) {
                        /* if present, the header is where you move the DIV from:*/
                        document.getElementById(elmnt.id + "header").onmousedown = dragMouseDown;
                      } else {
                        /* otherwise, move the DIV from anywhere inside the DIV:*/
                        elmnt.onmousedown = dragMouseDown;
                      }

                      function dragMouseDown(e) {
                        e = e || window.event;
                        e.preventDefault();
                        // get the mouse cursor position at startup:
                        pos3 = e.clientX;
                        pos4 = e.clientY;
                        document.onmouseup = closeDragElement;
                        // call a function whenever the cursor moves:
                        document.onmousemove = elementDrag;
                      }

                      function elementDrag(e) {
                        e = e || window.event;
                        e.preventDefault();
                        // calculate the new cursor position:

                        pos1 = pos3 - e.clientX;
                        pos3 = e.clientX;

                        // set the element's new position:
                        elmnt.style.top = (elmnt.offsetTop - pos2) + "px";
                        elmnt.style.left = (elmnt.offsetLeft - pos1) + "px";
                      }

                      function closeDragElement() {
                        /* stop moving when mouse button is released:*/
                        document.onmouseup = null;
                        document.onmousemove = null;
                      }
                    }

                </script>
                <div id="recommendations" style="padding-top: 20px; border: green;">
            </div>
        </main>
    </div>
</div>


<script src="/docs/5.1/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
        crossorigin="anonymous"></script>

<script src="https://cdn.jsdelivr.net/npm/feather-icons@4.28.0/dist/feather.min.js"
        integrity="sha384-uO3SXW5IuS1ZpFPKugNNWqTZRRglnUJK6UAZ/gxOX80nxEkN9NcGZTftn6RzhGWE"
        crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.4/dist/Chart.min.js"
        integrity="sha384-zNy6FEbO50N+Cg5wap8IKA4M/ZnLJgzc6w2NqACZaK0u0FXfOWRRJOnQtpZun8ha"
        crossorigin="anonymous"></script>
<script src="dashboard.js"></script>
</body>
